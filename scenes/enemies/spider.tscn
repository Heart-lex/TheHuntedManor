[gd_scene load_steps=16 format=3 uid="uid://dws74k17qnt02"]

[ext_resource type="PackedScene" uid="uid://bd4grjeylytoh" path="res://assets/dungeon/characters/spider/spider.gltf" id="1_drjoj"]
[ext_resource type="Script" path="res://scripts/enemies/spider.gd" id="2_p4e38"]
[ext_resource type="Script" path="res://scripts/shared/hitbox.gd" id="3_gmjw4"]
[ext_resource type="Script" path="res://scripts/shared/health_component_display.gd" id="3_iwmo3"]
[ext_resource type="Script" path="res://scripts/shared/hurtbox.gd" id="3_mryu7"]
[ext_resource type="PackedScene" uid="uid://d2ep8nb6bqfh6" path="res://scenes/health_component.tscn" id="3_wbj2b"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_5gq01"]
height = 1.79442
radius = 1.29323

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_t64so"]
radius = 1.79206
height = 3.58413

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_bsy52"]
animation = &"Spider_Attack_1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jo18h"]
animation = &"Spider_Death"

[sub_resource type="AnimationNodeTransition" id="AnimationNodeTransition_oo3xr"]
input_0/name = "Walk"
input_0/auto_advance = false
input_0/break_loop_at_end = false
input_0/reset = true
input_1/name = "Attack"
input_1/auto_advance = false
input_1/break_loop_at_end = false
input_1/reset = true
input_2/name = "Death"
input_2/auto_advance = false
input_2/break_loop_at_end = false
input_2/reset = true

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2307o"]
animation = &"Spider_Walk"

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_t7hhr"]
nodes/Attack/node = SubResource("AnimationNodeAnimation_bsy52")
nodes/Attack/position = Vector2(-186.667, 346.667)
nodes/Death/node = SubResource("AnimationNodeAnimation_jo18h")
nodes/Death/position = Vector2(-53.3333, 480)
nodes/Movement/node = SubResource("AnimationNodeTransition_oo3xr")
nodes/Movement/position = Vector2(106.667, 53.3333)
nodes/Walk/node = SubResource("AnimationNodeAnimation_2307o")
nodes/Walk/position = Vector2(-186.667, 186.667)
node_connections = [&"Movement", 0, &"Walk", &"Movement", 1, &"Attack", &"Movement", 2, &"Death", &"output", 0, &"Movement"]

[sub_resource type="BoxShape3D" id="BoxShape3D_7xgcp"]
size = Vector3(5.13416, 1.32202, 19.4851)

[sub_resource type="ViewportTexture" id="ViewportTexture_75p1a"]
viewport_path = NodePath("SubViewport")

[node name="spider" instance=ExtResource("1_drjoj")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -14, 0)
wall_min_slide_angle = 0.174533
script = ExtResource("2_p4e38")

[node name="Collision" type="CollisionShape3D" parent="." index="0"]
transform = Transform3D(0.982323, 0, -0.187193, 0, 1, 0, 0.187193, 0, 0.982323, -0.0788184, 14.9734, -0.0666404)
shape = SubResource("CylinderShape3D_5gq01")

[node name="Hitbox" type="Area3D" parent="." index="1" node_paths=PackedStringArray("health_component")]
collision_layer = 16
collision_mask = 4
input_ray_pickable = false
monitoring = false
script = ExtResource("3_gmjw4")
health_component = NodePath("../HealthComponent")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox" index="0"]
transform = Transform3D(0.982323, 0, -0.187193, 0, 1, 0, 0.187193, 0, 0.982323, -0.0788184, 14.9734, -0.0666404)
shape = SubResource("CylinderShape3D_5gq01")

[node name="Hurtbox" type="Area3D" parent="." index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 15.132, -0.429778)
collision_layer = 16
collision_mask = 4
input_ray_pickable = false
monitorable = false
script = ExtResource("3_mryu7")
always_enabled = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hurtbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.315232)
shape = SubResource("CapsuleShape3D_t64so")

[node name="Sketchfab_model" parent="." index="3"]
transform = Transform3D(-0.02, -1.74846e-09, 0, -7.64274e-17, 8.74228e-10, 0.02, -1.74846e-09, 0.02, -8.74228e-10, 0, 14.1735, 0)

[node name="f4c7dff2b8264fc5bf6d28e22753d2d4_fbx" parent="Sketchfab_model" index="0"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0)

[node name="Skeleton3D" parent="Sketchfab_model/f4c7dff2b8264fc5bf6d28e22753d2d4_fbx/Object_2/RootNode/Object_4" index="0"]
bones/2/position = Vector3(0, 20.6857, 17.2263)
bones/2/rotation = Quaternion(0.24268, 0.540293, 0.22287, 0.774286)
bones/2/scale = Vector3(1, 1, 1)
bones/3/rotation = Quaternion(0.00150999, 0.00380966, -0.0450939, 0.998974)
bones/4/position = Vector3(32.7145, 7.10543e-15, 0)
bones/5/rotation = Quaternion(-0.211489, -0.674739, -0.211489, 0.674739)
bones/5/scale = Vector3(1, 1, 1)
bones/6/rotation = Quaternion(-0.24878, -0.543779, -0.306413, 0.740624)
bones/6/scale = Vector3(1, 1, 1)
bones/7/rotation = Quaternion(-0.397793, -0.69992, -0.108098, 0.583256)
bones/8/rotation = Quaternion(-1.50649e-17, -2.36035e-17, 0.427328, 0.904097)
bones/9/rotation = Quaternion(1.71558e-17, 1.65283e-17, -0.778001, 0.628263)
bones/10/rotation = Quaternion(-2.83495e-17, 1.00542e-17, -0.4654, 0.8851)
bones/11/rotation = Quaternion(0.136641, 7.11105e-19, 5.15536e-18, 0.990621)
bones/12/rotation = Quaternion(-0.466422, -0.649858, -0.237248, 0.551225)
bones/13/rotation = Quaternion(-2.69886e-05, 1.51095e-05, 0.347437, 0.937703)
bones/14/rotation = Quaternion(-2.24954e-05, 1.38016e-05, -0.644843, 0.764315)
bones/15/rotation = Quaternion(-1.45678e-06, -2.68035e-06, -0.43854, 0.898712)
bones/17/rotation = Quaternion(-0.209491, -0.388165, -0.169161, 0.881378)
bones/17/scale = Vector3(1, 1, 1)
bones/18/rotation = Quaternion(0.000804234, -0.00072259, 0.211516, 0.977374)
bones/19/rotation = Quaternion(0.000502283, -0.000371825, -0.599372, 0.80047)
bones/20/rotation = Quaternion(-8.30855e-07, -2.66098e-06, -0.2983, 0.954472)
bones/22/rotation = Quaternion(-0.00276589, -0.271301, -0.146414, 0.951289)
bones/23/rotation = Quaternion(0.000200743, 2.24551e-05, 0.417221, 0.908805)
bones/24/rotation = Quaternion(0.00017305, -3.50598e-06, -0.715843, 0.698262)
bones/25/rotation = Quaternion(2.93669e-05, 7.01952e-05, -0.383726, 0.923447)
bones/27/rotation = Quaternion(0.59192, -0.106114, 0.754165, 0.263831)
bones/27/scale = Vector3(1, 1, 1)
bones/28/rotation = Quaternion(1.91655e-05, 1.36512e-05, 0.419112, 0.907935)
bones/29/rotation = Quaternion(2.42751e-05, 8.15079e-06, -0.718894, 0.69512)
bones/30/rotation = Quaternion(6.03256e-06, 1.38899e-05, -0.385933, 0.922527)
bones/32/rotation = Quaternion(0.662824, -0.0726696, 0.737022, 0.110375)
bones/32/scale = Vector3(1, 1, 1)
bones/33/rotation = Quaternion(6.13785e-06, -5.44469e-05, 0.206419, 0.978464)
bones/34/rotation = Quaternion(3.05668e-05, -2.23668e-05, -0.590833, 0.806794)
bones/35/rotation = Quaternion(7.58917e-09, 2.48152e-08, -0.293516, 0.955954)
bones/36/rotation = Quaternion(0.136641, 1.67401e-18, -5.59245e-19, 0.990621)
bones/37/rotation = Quaternion(0.788038, -0.367913, 0.478412, 0.121483)
bones/38/rotation = Quaternion(-1.6202e-05, -1.21356e-05, 0.350762, 0.936465)
bones/39/rotation = Quaternion(-2.06008e-05, -5.57402e-06, -0.660842, 0.750525)
bones/40/rotation = Quaternion(-6.73702e-06, -1.32318e-05, -0.453053, 0.891483)
bones/42/rotation = Quaternion(0.9186, -0.280677, 0.198483, 0.194931)
bones/43/rotation = Quaternion(-3.58312e-17, -4.41937e-17, 0.363389, 0.931637)
bones/44/rotation = Quaternion(7.30495e-18, 3.18022e-17, -0.596197, 0.802838)
bones/45/rotation = Quaternion(1.91466e-17, -2.43803e-17, -0.317908, 0.948122)
bones/46/rotation = Quaternion(0.136641, 6.16271e-18, -6.1035e-18, 0.990621)
bones/47/rotation = Quaternion(0.674739, -0.211489, 0.674739, 0.211489)
bones/47/scale = Vector3(1, 1, 1)
bones/48/rotation = Quaternion(0.543779, -0.24878, 0.740624, 0.306413)
bones/48/scale = Vector3(1, 1, 1)

[node name="pPlane1" parent="Sketchfab_model/f4c7dff2b8264fc5bf6d28e22753d2d4_fbx/Object_2/RootNode/Object_4" index="3"]
visible = false

[node name="pPlane1_Camera_lambert2_0" parent="Sketchfab_model/f4c7dff2b8264fc5bf6d28e22753d2d4_fbx/Object_2/RootNode/Object_4/pPlane1" index="0"]
visible = false

[node name="AnimationTree" type="AnimationTree" parent="." index="5"]
tree_root = SubResource("AnimationNodeBlendTree_t7hhr")
anim_player = NodePath("../AnimationPlayer")
parameters/Movement/current_state = "Walk"
parameters/Movement/transition_request = ""
parameters/Movement/current_index = 0

[node name="DetectionArea" type="Area3D" parent="." index="6"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 11.4217, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="DetectionArea" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.443176, 3.32454, -0.890117)
shape = SubResource("BoxShape3D_7xgcp")

[node name="HealthComponent" type="Node" parent="." index="7"]
script = ExtResource("3_iwmo3")
max_health = 40.0
health = 40.0

[node name="HealthbarPosition" type="Node3D" parent="." index="8"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 16.5234, 0)

[node name="HealthComponent2" parent="HealthbarPosition" index="0" node_paths=PackedStringArray("health_component") instance=ExtResource("3_wbj2b")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.165592, 0)
texture = SubResource("ViewportTexture_75p1a")
health_component = NodePath("../../HealthComponent")

[connection signal="area_entered" from="Hurtbox" to="." method="_on_hurtbox_area_entered"]
